/*! Coil Web Monetization for WordPress v1.6.0 Monday 6th April 2020 12:55:53 PM GMT+0100 */
!function(a){if("undefined"==typeof coil_params||!function(){var e;try{e=document.querySelector(coil_params.content_container)}catch(e){return console.log("An error occured when attempting to retrieve the page. Invalid container."),!1}if(e)return!0;return console.log("An error occured when attempting to retrieve the page. Container not found."),!1}())return;var o=coil_params.content_container,e=coil_params.browser_extension_missing,t=coil_params.unable_to_verify,n=coil_params.voluntary_donation,i=coil_params.loading_content,s=coil_params.partial_gating,c=coil_params.post_excerpt,r=coil_params.admin_missing_id_notice,l=coil_params.learn_more_button_text,d=coil_params.learn_more_button_link,m=coil_params.site_logo,u=Boolean(coil_params.show_donation_bar),g=wp.template("subscriber-only-message"),p=wp.template("split-content-message"),b=wp.template("banner-message"),f=a("p.monetize-msg");function h(e,o){var t=document.createElement("p");return t.classList.add("monetize-msg"),o&&t.classList.add(o),t.innerHTML=e,t}function y(e){var o=document.createElement("div");o.classList.add("entry-content","coil-message-container");var t={headerLogo:m,title:"This content is for Coil members only",content:e,button:{text:l,href:d}};return a(o).append(g(t)),o}function z(e){var o=document.createElement("div");o.classList.add("coil-banner-message-container");var t={content:e,button:{text:l,href:d}};return a(o).append(b(t)),o}function w(e){return p(e)}function _(){var e=document.querySelector(o);e&&(e.style.display="block")}function v(){if(""!==c){var e=document.createElement("p");return e.classList.add("coil-post-excerpt"),e.innerHTML=c,e}}function C(){return jQuery("p.coil-post-excerpt").remove()}function S(){return document.body.classList.contains("coil-no-gating")}function L(){return document.body.classList.contains("coil-gate-all")}function P(){return document.body.classList.contains("coil-gate-tagged-blocks")}function M(){return".content-area .entry-content"===o}function x(){return!!document.body.classList.contains("coil-show-excerpt")}function k(){0<a("p.monetize-msg").length&&(a("p.monetize-msg").remove(),L()?x()&&v()?(document.body.classList.add("show-excerpt-message"),a(o).before(y(t)),a(o).prepend(v())):(document.body.classList.add("show-fw-message"),a(o).before(y(t))):P()?(a(".coil-show-monetize-users").prepend(w(t)),a(".coil-hide-monetize-users").removeClass("coil-hide-monetize-users"),_(),A("ShowCoilPartialMsg")||(a("body").append(z(t)),E("ShowCoilPartialMsg"))):(document.body.classList.add("show-fw-message"),document.querySelector(o).before(y(t))))}function q(){return console.log("monetizationNotInitialized function ",document.body.classList),console.log(document.body.classList.contains("monetization-not-initialized")),document.body.classList.contains("monetization-not-initialized")}function E(e){console.log("addBannerDismissClickHandler ",e),a("#js-coil-banner-dismiss").on("click",function(){A(e)||("ShowCoilPublicMsg"===e?Cookies.set(e,1,{expires:31}):"ShowCoilPartialMsg"===e&&Cookies.set(e,1),a(this).parent().parent().remove())})}function A(e){var o=Cookies.get(e);return void 0===o||"ShowCoilPublicMsg"!==e&&"ShowCoilPartialMsg"!==e?(console.log("hasBannerDismissCookie is set ",o),!1):"1"===o}a(document).ready(function(){if(console.log(coil_params),q())if(console.log("monetizationNotInitialized "),S()||M()||a(o).not(".coil-post-excerpt").hide(),void 0!==document.monetization){switch(console.log("document.monetization !== 'undefined "),console.log(document.monetization.state),document.monetization.state){case"pending":document.body.classList.contains("coil-missing-id")?(console.log("isPaymentPointerMissing "),document.body.classList.contains("coil-show-admin-notice")?a(o).before(h(r,"admin-message")):a("body").removeClass("coil-missing-id"),S()||M()||(_(),a(o+"*.coil-hide-monetize-users").css("display","none"),a(o+"*.coil-show-monetize-users").css("display","none")),a("body").trigger("coil-missing-id")):S()?(console.log("show_donation_bar && monetizationNotInitialized() && ! hasBannerDismissCookie"),u&&q()&&!A("ShowCoilPublicMsg")&&(a("body").append(z(n)),E("ShowCoilPublicMsg"))):(console.log("! isMonetizedAndPublic "),L()?x()?document.querySelector(o).before(h(i,"")):a("p.coil-post-excerpt").after(h(i,"")):document.querySelector(o).before(h(i,"")),setTimeout(function(){C(),f.html(i)},2e3),setTimeout(function(){k()},5e3));break;case"started":document.querySelector(o).before(h(i,""));break;case"stopped":console.log("case stopped ",document.body.classList),(L()||P())&&(C(),function(){var e=document.querySelector(o);e&&(e.style.display="none")}(),document.querySelector(o).before(h(i,""))),setTimeout(function(){"undefined"==typeof monetizationStartEventOccurred&&(console.log("typeof monetizationStartEventOccurred === 'undefined'"),a("p.monetize-msg").text()===i?k():S()&&(console.log("show_donation_bar && ! hasBannerDismissCookie( 'ShowCoilPublicMsg' )"),u&&!A("ShowCoilPublicMsg")&&(a("body").append(z(n)),E("ShowCoilPublicMsg"))))},5e3)}document.monetization.addEventListener("monetizationstart",function(e){e.detail.paymentPointer,e.detail.requestId;monetizationStartEventOccurred=!0,S()||M()||(_(),document.body.classList.remove("show-fw-message"),x()&&C()),a("body").removeClass("monetization-not-initialized").addClass("monetization-initialized"),f.remove(),x()||a("div.coil-post-excerpt").remove(),document.querySelectorAll("iframe, object, video").forEach(function(e){if(e.classList.contains("intrinsic-ignore")||e.parentNode.classList.contains("intrinsic-ignore"))return!0;e.dataset.origwidth||(e.setAttribute("data-origwidth",e.width),e.setAttribute("data-origheight",e.height))}),a("body").trigger("coil-monetization-initialized",[e]),0<a("p.monetize-msg").length&&(a("p.monetize-msg").remove(),C(),_())}),document.monetization.addEventListener("monetizationprogress",function(e){var o=e.detail.paymentPointer,t=e.detail.requestId,n=e.detail.amount,i=e.detail.assetCode,s=e.detail.assetScale;a("body").trigger("coil-monetization-progress",[e,o,t,n,i,s])})}else a("body").removeClass("monetization-not-initialized").addClass("coil-extension-not-found"),L()?(a(o).before(y(e)),x()&&v()?(document.body.classList.add("show-excerpt-message"),a(o).prepend(v())):document.body.classList.add("show-fw-message")):P()?(a(".coil-show-monetize-users").prepend(w(s)),a(".coil-hide-monetize-users").removeClass("coil-hide-monetize-users"),_(),A("ShowCoilPartialMsg")||(a("body").append(z(s)),E("ShowCoilPartialMsg"))):S()&&(console.log("show_donation_bar && ! hasBannerDismissCookie( 'ShowCoilPublicMsg' ) "),u&&!A("ShowCoilPublicMsg")&&(a("body").append(z(n)),E("ShowCoilPublicMsg"))),a("body").trigger("coil-extension-not-found")})}(jQuery);